#-------------------------------------------------------------------------------#
#
#  This is the lammps input file
#
#-------------------------------------------------------------------------------#


#--------------------------- General Variables ---------------------------------#
  variable          nx     equal 1      # System size.
  variable          ny     equal 1      # System size.
  variable          nz     equal 1      # System size.
  variable          T      equal 200    # Temperature
  variable          rnd    equal 42     # seed for random velocities
  variable          t_run  equal 10     # number of MD steps
  variable	    ainmol equal 8	#atoms per molecule
  variable          t_print equal ${t_run}/10  #how often to print histogram
#-------------------------------------------------------------------------------#


#------------------------- Load initial setup ----------------------------------#
  include "system.init"

  read_data "Test_2aoutput.dat"

  # load force field parameters
  include "system.settings"
#-------------------------------------------------------------------------------#

  replicate         ${nx} ${ny} ${nz}
  
#---------------------- Thermostat & Barostat ----------------------------------#
  fix               f2 all npt temp $T $T $(100.0*dt) iso 0.0 0.0 $(1000.0*dt) 
#-------------------------------------------------------------------------------#

  velocity          all create $T ${rnd} mom yes rot yes dist gaussian
  write_data        urea_${nx}x${ny}x${nz}_equi.data

#------------------ Computes, variables & modifications ------------------------#
  variable          step    equal step
  variable          time    equal time
  variable          temp    equal temp
  variable          press   equal press
  variable          etot    equal etotal
  variable          ftemp   format temp "%10.3f"
  variable          fpress  format press "%.6e"
  variable          fetot   format etot "%.6e"
#-------------------------------------------------------------------------------#

#--------------------------- Thermo style and settings -------------------------#
  thermo_style      custom step time temp press vol etotal epair emol 
  thermo_modify     format float "%15.6f"
  thermo_modify     format 2 "%10.3f"
  thermo_modify     format 6 "%.6e"
  thermo_modify     format 7 "%.6e"
  thermo_modify     format 8 "%.6e"
  thermo_modify     flush yes
  timestep          1.0
  thermo            100

#-------------------------------------------------------------------------------#


#------------------------ Running the simulation -------------------------------#
    
  fix		    1 all dafedgen outfile dAFED.log dafedfile dAFED.in totalsymf 24

  fix               f4 all print 10 "${step}   ${time} ${ftemp}   ${fpress}   ${fetot}" &
                    screen no file thermo_run.txt &
                    title "# step   time[fs]   T[K]   P[atm]   Etot[kcal/mol]"

  dump              d1 all custom 1 traj.dump id mol element x y z vx vy vz fx fy fz f_1[*]
  dump_modify       d1 element 1 2 3 4 5 6 7 8 9 10

  run               ${t_run}

  write_data        urea_${nx}x${ny}x${nz}_final.data
#-------------------------------------------------------------------------------#
